title: 第三章 集合框架
date: 2018-2-6 22:25:12
categories: 编程基础
---
　　集合是我们在开发中最常用到的工具，本章我们就来分析一下java里集合框架的设计，对集合框架了如指掌是我们的学习要求^_^。
## 什么是集合 ##
　　`集合`源自数学中的一个概念，代表了一个或多个确定的对象组成的整体，而这些对象就被称为集合中的`元素`。
　　通俗来讲，集合就是一个用来存放数据的容器，java中集合是用来存放一系列的java对象而设计的一个类库，这个类库在`java.util`包下，根据不同的用途或者作用，有着不同的实现类，像常用的`ArrayList`、`HashMap`等等。
## 集合概况 ##
　　对于集合的整体概况有一个完整的结构图大家可以看一下：
　　![集合][1]
　　
　　从图中可以看出java集合中分了两个体系：
　　一个是以`Collection`接口为根节点的列表集合。
    
    Collection接口下是有多个集合接口组成`List`、`Set`、`Queue`：
    
    - 实现List接口的有：ArrayList、LinkedList
    - 实现Set接口的有：HashSet、LinkedHashSet、TreeSet
    - 实现Queue接口的有：PriorityQueue、LinkedList、ArrayQueue

　　另一个则是以`Map`接口为根节点的`key-value`集合。
    
    - 实现Map接口的有：EnumMap、IdentityHashMap、HashMap、LinkedHashMap、WeakHashMap、TreeMap

**本节参考**
- [集合原图](http://pierrchen.blogspot.com/2014/03/java-collections-framework-cheat-sheet.html)

## Collection ##
　　Collection接口定义了一个包含一批对象的集合。接口的主要方法包括：

    size() - 集合内的对象数量
    add(E)/addAll(Collection) - 向集合内添加单个/批量对象
    remove(Object)/removeAll(Collection) - 从集合内删除单个/批量对象
    contains(Object)/containsAll(Collection) - 判断集合中是否存在某个/某些对象
    toArray() - 返回包含集合内所有对象的数组等
### List ###
　　`List`接口继承自`Collection`，用于定义以列表形式存储的集合，List接口为集合中的每个对象分配了一个索引(index)，标记该对象在List中的位置，并可以通过index定位到指定位置的对象。

    List在Collection基础上增加的主要方法包括：
    - get(int) - 返回指定index位置上的对象
    - add(E)/add(int, E) - 在List末尾/指定index位置上插入一个对象
    - set(int, E) - 替换置于List指定index位置上的对象
    - indexOf(Object) - 返回指定对象在List中的index位置
    - subList(int,int) - 返回指定起始index到终止index的子List对象等
　　List集合中的数据的特征是有序、可重复的。
#### ArrayList ####
　　`ArrayList`是`List`接口的一个实现，属于非[线程安全][2]的，原理是内部维护了一个可变长度的数组。
　　`ArrayList`提供了三个构造函数分别是
    
    - ArrayList()  无参构造函数会初始化一个空的Object数组
    - ArrayList(int initialCapacity)  入参int类型的构造函数会初始化一个指定大小的Object数组，如果入参为负值，会抛出IllegalArgumentException异常
    - ArrayList(Collection<? extends E> c)  入参为集合类型的构造函数会先将c转换成一个数组，判断数组类型，如果不是Object数组会使用Array.copy方法进行复制。
　　下面是`ArrayList`中的一些常用方法，简单说一下实现：
    
    - add(E e)  首先E是一个泛型，也就是我们在实例化ArrayList的时候指定的数据类型，调用add方法之后会进行计算，当前内部数组的长度是否足够，如果足够就e添加到数组的最后，然后返回true。
    - add(int index, E element)  添加数据到指定位置，方法中的逻辑是，首先判断位置是否合理，校验内部数组长度是否足够，不够的话会进行扩展，然后调用System.arraycopy(elementData, index, elementData, index + 1, size - index);将从数组的指定位置的数据复制到指定位置，也就是从指定位置开始往后挪一位，最后将element添加到指定位置。因为System.arraycopy是直接操作的内存块，所以速度很快。
    - addAll(Collection<? extends E> c)  添加另一个集合的所有数据到当前集合，首先将c集合转换为Object数组，然后使用System.arraycopy将数组复制到内部数组的指定位置。
    - get(int index)  很简单，直接获取内部数组指定位置的数据。
    - indexOf(Object o)  返回o在内部数组中的位置，因为ArrayList是包含重复数据的，所以只会返回第一个相同数据的所在位置，内部实现是通过for循环遍历。
    - lastIndexOf(Object o) 返回o在内部数组中的位置，实现同indexOf，不同的只是当前方法时从内部数组的最后往前遍历。
    - contains(Object o)  是否包含指定数据，内部调用了indexOf方法，判断返回值是否>=0。
    - toArray()  返回一个内部数组的复制。和原数组不是同一个引用。
    - E remove(int index)  移除数组中指定位置的数据，并返回对应的数据。实现也是通过System.arraycopy的复制。
**本节拓展**
- [System.arraycopy](http://blog.csdn.net/fangchengimz/article/details/50537306)

#### LinkedList ####
　　`LinkedList`是`List`接口的一个实现，属于非[线程安全][2]的，原理是内部维护了一个双向链表。
　　LinkedList内部数据成员有三个`int size`、`Node<E> first`、`Node<E> last`，first是双向链表的第一个节点，last是最后一个节点，Node是LinkedList的一个内部类，包含指向上一个和下一个节点的引用，和当前节点的数据。

## Map ##
　　挖坑，后面补充


  [1]: /img/codebase3-1.jpg
  [2]: https://baike.baidu.com/item/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/9747724?fr=aladdin